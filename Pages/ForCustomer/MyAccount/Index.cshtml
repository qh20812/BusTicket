@page
@model BusTicketSystem.Pages.ForCustomer.MyAccount.IndexModel
@{
    Layout="_AccountInfoLayout";
    ViewData["Title"]="Thông tin cá nhân";
}

<div class="header">
    <div class="left">
        <h1>@ViewData["Title"]</h1>
        <ul class="breadcrumb">
            <li><a asp-page="/Index" style="text-decoration: none;">Trang chủ</a></li>
            /
            <li><a asp-page="/ForCustomer/MyAccount/Index" class="active" style="text-decoration: none;">Tài khoản</a></li>
            /
            <li><a asp-page="/ForCustomer/MyAccount/Index" class="active" style="text-decoration: none;">Thông tin cá nhân</a></li>
        </ul>
    </div>
</div>

<div class="bottom-data">
    <div class="orders"> @* Sử dụng class 'orders' để có thể tái sử dụng style từ _adminlayout.css (nay là _accountinfolayout.css) *@
        <div class="header">
            <i class='bi bi-person-fill-gear bx'></i>
            <h3>Chỉnh sửa thông tin cá nhân</h3>
        </div>
        <div class="card-body" style="padding: 20px;">
            @if (!string.IsNullOrEmpty(Model.SuccessMessage))
            {
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    @Model.SuccessMessage
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            }
            @if (!string.IsNullOrEmpty(Model.ErrorMessage))
            {
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    @Model.ErrorMessage
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            }
            <form method="post">
                <input type="hidden" asp-for="Profile.UserId" />
                <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

                @* <div class="mb-4 text-center avatar-upload-container">
                    <label for="Profile_AvatarFile" class="avatar-upload-wrapper">
                        <img id="avatarPreview" 
                             src="@Url.Content("~" + (Model.Profile.CurrentAvatarPath ?? "/images/logo2.png"))"
                             alt="User Avatar" 
                             class="avatar-image-preview" />
                        <span class="change-avatar-prompt">Đổi ảnh đại diện</span>
                    </label>
                    <input asp-for="Profile.AvatarFile" type="file" class="d-none" id="Profile_AvatarFile" accept="image/*" onchange="previewAvatar(event)" />
                    <span asp-validation-for="Profile.AvatarFile" class="text-danger d-block mt-2"></span>
                </div> *@

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label asp-for="Profile.Username" class="form-label"></label>
                        <input asp-for="Profile.Username" class="form-control" readonly />
                    </div>
                    <div class="col-md-6 mb-3">
                        <label asp-for="Profile.Email" class="form-label"></label>
                        <input asp-for="Profile.Email" class="form-control" />
                        <span asp-validation-for="Profile.Email" class="text-danger"></span>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label asp-for="Profile.Fullname" class="form-label"></label>
                        <input asp-for="Profile.Fullname" class="form-control" />
                        <span asp-validation-for="Profile.Fullname" class="text-danger"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label asp-for="Profile.Phone" class="form-label"></label>
                        <input asp-for="Profile.Phone" class="form-control" />
                        <span asp-validation-for="Profile.Phone" class="text-danger"></span>
                    </div>
                </div>

                <div class="mb-3">
                    <label asp-for="Profile.Address" class="form-label"></label>
                    <textarea asp-for="Profile.Address" class="form-control" rows="3"></textarea>
                    <span asp-validation-for="Profile.Address" class="text-danger"></span>
                </div>

                <hr />
                <h5 class="mt-4 mb-3">Thay đổi mật khẩu</h5>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label asp-for="Profile.NewPassword" class="form-label"></label>
                        <input asp-for="Profile.NewPassword" type="password" class="form-control" autocomplete="new-password" />
                        <span asp-validation-for="Profile.NewPassword" class="text-danger"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label asp-for="Profile.ConfirmNewPassword" class="form-label"></label>
                        <input asp-for="Profile.ConfirmNewPassword" type="password" class="form-control" autocomplete="new-password" />
                        <span asp-validation-for="Profile.ConfirmNewPassword" class="text-danger"></span>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary mt-3">Lưu thay đổi</button>
                <a asp-page="/Index" class="btn btn-secondary mt-3">Quay lại Trang chủ</a>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    @* <style>
        .avatar-upload-wrapper {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 180px; /* Kích thước hình tròn lớn hơn */
            height: 180px; /* Kích thước hình tròn lớn hơn */
            border-radius: 50%;
            border: 3px solid #ddd;
            background-color: #f8f9fa;
            cursor: pointer;
            overflow: hidden;
            padding: 10px;
            box-sizing: border-box;
            transition: border-color 0.3s ease, background-color 0.3s ease;
        }

        .avatar-upload-wrapper:hover {
            border-color: var(--primary, #007bff); /* Sử dụng biến CSS nếu có, hoặc màu mặc định */
            background-color: #e9ecef;
        }

        .avatar-image-preview {
            width: 100px; /* Kích thước ảnh bên trong */
            height: 100px; /* Kích thước ảnh bên trong */
            object-fit: cover;
            border-radius: 50%;
            margin-bottom: 8px; /* Khoảng cách giữa ảnh và chữ */
        }

        .change-avatar-prompt {
            font-size: 0.9em;
            color: #333;
            text-align: center;
        }
    </style> *@
    @* <script>
        function previewAvatar(event) {
            var reader = new FileReader();
            reader.onload = function () {
                var output = document.getElementById('avatarPreview');
                output.src = reader.result;
            };
            reader.readAsDataURL(event.target.files[0]);
        }
    </script> *@
}